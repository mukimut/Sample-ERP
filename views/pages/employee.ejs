<style>
  .leftMargin {
    margin-left: 5px !important;
  }

  .btnMarginTop {
    margin-top: 8px;
  }

  .secMargin {
    margin-left: 10px;
  }
</style>
<div class="content-wrapper">
  <section class="content-header secMargin">
    <h1>Employee<small>Profile</small></h1>
    <ol class="breadcrumb">
      <li><a href="#"><i class="fa fa-dashboard"></i> Home</a></li>
      <li><a href="#">Master</a></li>
      <li class="active">Employee</li>
    </ol>
  </section>
  <section class="invoice">
    <div class="row">
      <div class="col-xs-12">
        <h2 class="page-header">Employee Identification<small class="pull-right">
            <script>
              var d = new Date();
              document.write(d.toLocaleString());
            </script>
          </small></h2>
      </div>
    </div>
    <div class="row">
      <div class="col-md-12">
        <!-- Custom Tabs -->
        <div class="nav-tabs-custom">
          <ul class="nav nav-tabs">
            <li class="active"><a href="#tab_1" data-toggle="tab">Basic Info</a></li>
            <li><a href="#tab_2" data-toggle="tab">Employment Details</a></li>
            <li><a href="#tab_3" data-toggle="tab">Prior Experience</a></li>
          </ul>
          <div class="tab-content">
            <div class="tab-pane active" id="tab_1">
              <div class="row">
                <div class="col-md-12 form-horizontal">
                  <div class="box-body">
                    <div class="row">
                      <div class="col-md-6">
                        <div class="row">
                          <div class="form-group">
                            <div class="col-sm-12">
                              <input type="text" class="form-control" id="name" placeholder="First Name">
                            </div>
                          </div>
                          <div class="form-group">
                            <div class="col-sm-12">
                              <input type="text" class="form-control" id="name" placeholder="Middle Name">
                            </div>
                          </div>
                          <div class="form-group">
                            <div class="col-sm-12">
                              <input type="text" class="form-control" id="title" placeholder="Title">
                            </div>
                          </div>
                          <div class="form-group">
                            <div class="col-sm-12">
                              <input type="text" class="form-control" id="tin" placeholder="Fathers Name">
                            </div>
                          </div>
                          <div class="form-group">
                            <div class="col-sm-12">
                              <!-- <label>Date of Birth</label> -->
                              <input type="date" class="form-control" id="dateOfBirth" name="dateOfBirth">
                            </div>
                          </div>
                          <div class="form-group">
                            <div class="col-sm-12">
                              <input type="text" class="form-control" id="tin" placeholder="Birth Place">
                            </div>
                          </div>
                          <div class="form-group">
                            <div class="col-sm-12">
                              <select id="gender" class="form-control">
                                <option selected>Blood Group</option>
                                <option>A+</option>
                                <option>B+</option>
                              </select>
                            </div>
                          </div>
                          <div class="form-group">
                            <div class="col-sm-12">
                              <select id="gender" class="form-control">
                                <option selected>Religion</option>
                                <option>Islam</option>
                                <option>Hindue</option>
                              </select>
                            </div>
                          </div>
                          <div class="form-group">
                            <div class="col-sm-12">
                              <input type="text" class="form-control" id="tin" placeholder="National Id No">
                            </div>
                          </div>
                          <div class="form-group">
                            <div class="col-sm-12">
                              <input type="text" class="form-control" id="tin" placeholder="Driving License No">
                            </div>
                          </div>
                          <div class="form-group">
                            <div class="col-sm-12">
                              <input type="text" class="form-control" id="tin" placeholder="TIN No">
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-md-6">
                        <div class="row">
                          <div class="form-group leftMargin">
                            <div class="col-sm-12">
                              <input type="text" class="form-control" id="name" placeholder="Last Name">
                            </div>
                          </div>
                          <div class="form-group leftMargin">
                            <div class="col-sm-12">
                              <input type="text" class="form-control" id="nickNmae" placeholder="Nick Name">
                            </div>
                          </div>
                          <div class="form-group leftMargin">
                            <div class="col-sm-12">
                              <input type="text" class="form-control" id="website" placeholder="Mothers Name">
                            </div>
                          </div>
                          <div class="form-group leftMargin">
                            <div class="col-sm-12">
                              <input type="text" class="form-control" id="website" placeholder="Mothers Name">
                              <!-- <input type="checkbox" name="vehicle1" value="doctorsAproval"> Doctor's Approval -->
                            </div>
                          </div>
                          <div class="form-group leftMargin">
                            <div class="col-sm-12">
                              <input type="text" class="form-control" id="age" placeholder="Age">
                            </div>
                          </div>
                          <div class="form-group leftMargin">
                            <div class="col-sm-12">
                              <select id="gender" class="form-control">
                                <option selected>Gender</option>
                                <option>Male</option>
                                <option>Female</option>
                              </select>
                            </div>
                          </div>
                          <div class="form-group leftMargin">
                            <div class="col-sm-12">
                              <select id="gender" class="form-control">
                                <option selected>Merital Status</option>
                                <option>Married</option>
                                <option>UnMarried</option>
                                <option>Single</option>
                              </select>
                            </div>
                          </div>
                          <div class="form-group leftMargin">
                            <div class="col-sm-12">
                              <input type="text" class="form-control" id="nationality" placeholder="Nationality">
                            </div>
                          </div>
                          <div class="form-group leftMargin">
                            <div class="col-sm-12">
                              <input type="text" class="form-control" id="passportNo" placeholder="Passport No">
                            </div>
                          </div>
                          <div class="form-group leftMargin">
                            <div class="col-sm-12">
                              <input type="text" class="form-control" id="licencenseExpiry" placeholder="License Expiry Date">
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="row">
                        <h2 class="page-header">Present Address</h2>
                    </div>
                    <div class="row" id="addressArea">
                      <div class="col-md-11 form-horizontal">
                          <div class="row">
                            <div class="col-md-6">
                              <div class="row">
                                <div class="form-group">
                                  <div class="col-sm-12">
                                    <select id="addressType0" class="form-control">
                                      <option selected>Address Type </option>
                                      <option>Organisation Address </option>
                                      <option>Head Quarter Address </option>
                                      <option>Factory Address </option>
                                      <option>Delivery Address </option>
                                    </select>
                                  </div>
                                </div>
                                <div class="form-group">
                                  <div class="col-sm-12">
                                    <select id="addressType0" class="form-control">
                                      <option selected>Division </option>
                                      <option>Chittagong </option>
                                      <option>Rajshahi </option>
                                      <option>Dhaka </option>
                                      <option>Jessore </option>
                                    </select>
                                  </div>
                                </div>
                                <div class="form-group">
                                  <div class="col-sm-12">
                                    <select id="addressType0" class="form-control">
                                      <option selected>Police Station </option>
                                      <option>Akkelpur </option>
                                      <option>Adamdighi </option>
                                      <option>Atrai </option>
                                      <option>Bagatipara </option>
                                    </select>
                                  </div>
                                </div>
                                <div class="form-group">
                                  <div class="col-sm-12">
                                      <input type="text" class="form-control" id="hpf0" placeholder="Post Code">
                                  </div>
                                </div>
                                <div class="form-group">
                                    <div class="col-sm-12">
                                        <input type="text" class="form-control" id="hpf0" placeholder="House/ Plot/ Flat">
                                    </div>
                                  </div>
                              </div>
                            </div>
                            <div class="col-md-6">
                              <div class="row">
                                <div class="form-group leftMargin">
                                  <div class="col-sm-12">
                                    <select id="addressType0" class="form-control">
                                      <option selected>Country </option>
                                      <option>Algeria </option>
                                      <option>Andorra </option>
                                      <option>Angola </option>
                                      <option>Bangladesh </option>
                                    </select>
                                  </div>
                                </div>
                                <div class="form-group leftMargin">
                                  <div class="col-sm-12">
                                    <select id="addressType0" class="form-control">
                                      <option selected>District </option>
                                      <option>Chittagong </option>
                                      <option>Rajshahi </option>
                                      <option>Dhaka </option>
                                      <option>Jessore </option>
                                    </select>
                                  </div>
                                </div>
                                <div class="form-group leftMargin">
                                  <div class="col-sm-12">
                                    <select id="addressType0" class="form-control">
                                      <option selected>Post Office </option>
                                      <option>Kotwali </option>
                                      <option>Ramna </option>
                                      <option>Kamrangichor </option>
                                      <option>Sotrapur </option>
                                    </select>
                                  </div>
                                </div>
                                <div class="form-group leftMargin">
                                  <div class="col-sm-12">
                                      <input type="text" class="form-control" id="var0" placeholder="Village/ Area/ Road">
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                      </div>
                      <div class="col-md-1">
                        <button class="btn btn-flat btn-success" onclick="addAddress()">Add</button>
                      </div>
                    </div>
                    <div class="row">
                        <h2 class="page-header">Permanent Address</h2>
                    </div>
                    <div class="row" id="addressArea">
                      <div class="col-md-11 form-horizontal">
                          <div class="row">
                            <div class="col-md-6">
                              <div class="row">
                                <div class="form-group">
                                  <div class="col-sm-12">
                                    <select id="addressType0" class="form-control">
                                      <option selected>Address Type </option>
                                      <option>Organisation Address </option>
                                      <option>Head Quarter Address </option>
                                      <option>Factory Address </option>
                                      <option>Delivery Address </option>
                                    </select>
                                  </div>
                                </div>
                                <div class="form-group">
                                  <div class="col-sm-12">
                                    <select id="addressType0" class="form-control">
                                      <option selected>Division </option>
                                      <option>Chittagong </option>
                                      <option>Rajshahi </option>
                                      <option>Dhaka </option>
                                      <option>Jessore </option>
                                    </select>
                                  </div>
                                </div>
                                <div class="form-group">
                                  <div class="col-sm-12">
                                    <select id="addressType0" class="form-control">
                                      <option selected>Police Station </option>
                                      <option>Akkelpur </option>
                                      <option>Adamdighi </option>
                                      <option>Atrai </option>
                                      <option>Bagatipara </option>
                                    </select>
                                  </div>
                                </div>
                                <div class="form-group">
                                  <div class="col-sm-12">
                                      <input type="text" class="form-control" id="hpf0" placeholder="Post Code">
                                  </div>
                                </div>
                                <div class="form-group">
                                    <div class="col-sm-12">
                                        <input type="text" class="form-control" id="hpf0" placeholder="House/ Plot/ Flat">
                                    </div>
                                  </div>
                              </div>
                            </div>
                            <div class="col-md-6">
                              <div class="row">
                                <div class="form-group leftMargin">
                                  <div class="col-sm-12">
                                    <select id="addressType0" class="form-control">
                                      <option selected>Country </option>
                                      <option>Algeria </option>
                                      <option>Andorra </option>
                                      <option>Angola </option>
                                      <option>Bangladesh </option>
                                    </select>
                                  </div>
                                </div>
                                <div class="form-group leftMargin">
                                  <div class="col-sm-12">
                                    <select id="addressType0" class="form-control">
                                      <option selected>District </option>
                                      <option>Chittagong </option>
                                      <option>Rajshahi </option>
                                      <option>Dhaka </option>
                                      <option>Jessore </option>
                                    </select>
                                  </div>
                                </div>
                                <div class="form-group leftMargin">
                                  <div class="col-sm-12">
                                    <select id="addressType0" class="form-control">
                                      <option selected>Post Office </option>
                                      <option>Kotwali </option>
                                      <option>Ramna </option>
                                      <option>Kamrangichor </option>
                                      <option>Sotrapur </option>
                                    </select>
                                  </div>
                                </div>
                                <div class="form-group leftMargin">
                                  <div class="col-sm-12">
                                      <input type="text" class="form-control" id="var0" placeholder="Village/ Area/ Road">
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                      </div>
                      <div class="col-md-1">
                        <button class="btn btn-flat btn-success" onclick="addAddress()">Add</button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

            </div>
            <!-- /.tab-pane -->
            <div class="tab-pane" id="tab_2">
              <div class="row">
                <div class="col-md-12 form-horizontal">
                  <div class="box-body">
                    <div class="row">
                      <div class="col-md-6">
                        <div class="row">
                          <div class="form-group">
                            <div class="col-sm-12">
                              <input type="text" class="form-control" id="name" placeholder="Employee Id">
                            </div>
                          </div>
                          <div class="form-group">
                            <div class="col-sm-12">
                              <input type="text" class="form-control" id="name" placeholder="Barcode">
                            </div>
                          </div>
                          <div class="form-group">
                            <div class="col-sm-12">
                              <input type="text" class="form-control" id="title" placeholder="Access Code">
                            </div>
                          </div>
                          <div class="form-group">
                            <div class="col-sm-12">
                              <input type="text" class="form-control" id="tin" placeholder="Org Stracture">
                            </div>
                          </div>
                          <div class="form-group">
                            <div class="col-sm-12">
                              <select id="gender" class="form-control">
                                <option selected>Administrative Office</option>
                                <option>A+</option>
                                <option>B+</option>
                              </select>
                            </div>
                          </div>
                          <div class="form-group">
                            <div class="col-sm-12">
                              <select id="gender" class="form-control">
                                <option selected>Department</option>
                                <option>IT</option>
                                <option>HR</option>
                              </select>
                            </div>
                          </div>
                          <div class="form-group">
                            <div class="col-sm-12">
                              <select id="gender" class="form-control">
                                <option selected>Section</option>
                                <option>System Administration</option>
                                <option>B+</option>
                              </select>
                            </div>
                          </div>
                          <div class="form-group">
                            <div class="col-sm-12">
                              <select id="gender" class="form-control">
                                <option selected>Religion</option>
                                <option>Islam</option>
                                <option>Hindue</option>
                              </select>
                            </div>
                          </div>
                          <div class="form-group">
                            <div class="col-sm-12">
                              <input type="text" class="form-control" id="tin" placeholder="National Id No">
                            </div>
                          </div>
                          <div class="form-group">
                            <div class="col-sm-12">
                              <input type="text" class="form-control" id="tin" placeholder="Driving License No">
                            </div>
                          </div>
                          <div class="form-group">
                            <div class="col-sm-12">
                              <input type="text" class="form-control" id="tin" placeholder="TIN No">
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-md-6">
                        <div class="row">
                          <div class="form-group leftMargin">
                            <div class="col-sm-12">
                              <input type="text" class="form-control" id="name" placeholder="Work Area">
                            </div>
                          </div>
                          <div class="form-group leftMargin">
                            <div class="col-sm-12">
                              <input type="text" class="form-control" id="nickNmae" placeholder="Nick Name">
                            </div>
                          </div>
                          <div class="form-group leftMargin">
                            <div class="col-sm-12">
                              <input type="text" class="form-control" id="website" placeholder="Mothers Name">
                            </div>
                          </div>
                          <div class="form-group leftMargin">
                            <div class="col-sm-12">
                              <input type="text" class="form-control" id="website" placeholder="Mothers Name">
                              <!-- <input type="checkbox" name="vehicle1" value="doctorsAproval"> Doctor's Approval -->
                            </div>
                          </div>
                          <div class="form-group leftMargin">
                            <div class="col-sm-12">
                              <input type="text" class="form-control" id="age" placeholder="Age">
                            </div>
                          </div>
                          <div class="form-group leftMargin">
                            <div class="col-sm-12">
                              <select id="gender" class="form-control">
                                <option selected>Gender</option>
                                <option>Male</option>
                                <option>Female</option>
                              </select>
                            </div>
                          </div>
                          <div class="form-group leftMargin">
                            <div class="col-sm-12">
                              <select id="gender" class="form-control">
                                <option selected>Merital Status</option>
                                <option>Married</option>
                                <option>UnMarried</option>
                                <option>Single</option>
                              </select>
                            </div>
                          </div>
                          <div class="form-group leftMargin">
                            <div class="col-sm-12">
                              <input type="text" class="form-control" id="nationality" placeholder="Nationality">
                            </div>
                          </div>
                          <div class="form-group leftMargin">
                            <div class="col-sm-12">
                              <input type="text" class="form-control" id="passportNo" placeholder="Passport No">
                            </div>
                          </div>
                          <div class="form-group leftMargin">
                            <div class="col-sm-12">
                              <input type="text" class="form-control" id="licencenseExpiry" placeholder="License Expiry Date">
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <!-- /.tab-pane -->
            <div class="tab-pane" id="tab_3">
              Test
            </div>
            <!-- /.tab-pane -->
          </div>
          <!-- /.tab-content -->
        </div>
        <!-- nav-tabs-custom -->
      </div>
      <!-- /.col -->
    </div>


</div>


</section>
<div class="clearfix"></div>
</div>

<script src="/js/dropdown.js"></script>
<script>
  const idList = ['name', 'shortname', 'phone', 'email', 'website', 'tin'];
  addressIds = ['district', 'policestation', 'postcode', 'hpf', 'var', 'postOffice'];
  contactIds = ['displayName', 'department', 'contactNo', 'email', 'designation'];
  let allCompanies = [];
  let selectedId;
  let addressSize = 1;
  let contactSize = 1;

  getCompanies();

  function getSubmitData() {
    const object = {};
    idList.forEach(element => object[element] = getInputValue(element));

    object['companytype'] = getSelectedText('companyType').toLowerCase();

    object['address'] = [];
    for (let i = 0; i < addressSize; i++) {
      const addressObject = {};
      addressIds.forEach(element => addressObject[element] = getInputValue(element + '' + i));
      addressObject['addressType'] = getSelectedText('addressType' + i);
      object['address'].push(addressObject);
    }

    object['contact'] = [];
    for (let i = 0; i < contactSize; i++) {
      const personObject = {};
      contactIds.forEach(element => personObject[element] = getInputValue(element + '' + i));
      object['contact'].push(personObject);
    }

    return object;
  }

  function getInputValue(id) {
    let currentValue = document.getElementById(id).value;
    if (!currentValue) currentValue = '';
    return currentValue;
  }

  function getCompanies() {
    $.get('api/companies', (res) => {
      allCompanies = res;
      displayList();
    });
  }

  function displayList() {
    let string = '';
    const length = allCompanies.length;

    for (let i = 0; i < length; i++) {
      const currentCompany = allCompanies[i];
      string += '<tr><td>' + currentCompany.name + '</td><td>' + currentCompany.shortname + '</td>'
      string += '<td>' + currentCompany.phone + '</td><td>' + currentCompany.email + '</td>';
      string += '<td>' + currentCompany.website + '</td>';
      string += `<td><button class="label label-primary" onclick="edit(` + i + `)">Edit</button>&nbsp;&nbsp;
                <button class="label label-danger" onclick="deleteRecord(` + i + `)">Delete</button></td></tr>`;
    }
    document.getElementById('companylist').innerHTML = string;
  }

  function addContact() {
    const string = `<div class="col-md-11 form-horizontal"><div class="box-body"><div class="row"><div class="col-md-6">
      <div class="row"><div class="form-group"><div class="col-sm-12"><input type="text" class="form-control" id="displayName`
      + contactSize + `" placeholder="Display Name"></div></div><div class="form-group"><div class="col-sm-12"><input type="text" 
      class="form-control" id="designation` + contactSize + `" placeholder="Designation"></div></div><div class="form-group">
      <div class="col-sm-12"><input type="text" class="form-control" id="email` + contactSize + `" placeholder="Email Address">
      </div></div></div></div><div class="col-md-6"><div class="row"><div class="form-group leftMargin"><div class="col-sm-12 ">
      <input type="text" class="form-control" id="department` + contactSize + `" placeholder="Department"></div></div><div class="form-group 
      leftMargin"><div class="col-sm-12"><input type="text" class="form-control" id="contactNo` + contactSize + `" placeholder="Contact No">
      </div></div></div></div></div></div></div>`
    contactSize++;
    let dom = document.getElementById('contactPerson').innerHTML;
    dom += string;
    document.getElementById('contactPerson').innerHTML = dom;
  }

  function addAddress() {
    const address = `<div class="col-md-11 form-horizontal"><div class="box-body"><div class="row"><div class="col-md-6">
        <div class="row"><div class="form-group"><div class="col-sm-12"><select id="addressType` + addressSize + `" class=
        "form-control"><option selected> Select Address Type </option><option>Organisation Address </option><option>Head Quarter 
        Address </option><option>Factory Address </option><option>Delivery Address </option></select></div></div><div class="form-group">
        <div class="col-sm-12"><input type="text" class="form-control" id="policestation` + addressSize + `" placeholder="Police Station">
        </div></div><div class="form-group"><div class="col-sm-12"><input type="text" class="form-control" id="postcode` + addressSize + `" 
        placeholder="Post Code"></div></div><div class="form-group"><div class="col-sm-12"><input type="text" class="form-control" id="var`
      + addressSize + `" placeholder="Village/ Area/ Road"></div></div></div></div><div class="col-md-6"><div class="row"><div class="form-group 
        leftMargin"><div class="col-sm-12"><input type="text" class="form-control" id="district` + addressSize + `" placeholder="District"></div>
        </div><div class="form-group leftMargin"><div class="col-sm-12"><input type="text" class="form-control" id="postOffice` + addressSize + `" 
        placeholder="Post Office"></div></div><div class="form-group leftMargin"><div class="col-sm-12"><input type="text" class="form-control" 
        id="hpf` + addressSize + `" placeholder="House/ Plot/ Flat"></div></div></div></div></div></div></div>`

    addressSize++;
    let dom = document.getElementById('addressArea').innerHTML;
    dom += address;
    document.getElementById('addressArea').innerHTML = dom;
  }

  function edit(index) {
    selectedId = allCompanies[index].id;

    idList.forEach(element => {
      document.getElementById(element).value = allCompanies[index][element];
    });

    setSelectedValue('companyType', allCompanies[index].companytype.toUpperCase());

    document.getElementById('addressArea').innerHTML = '';
    addressSize = 0;
    const addresses = allCompanies[index].address;
    let length = addresses.length;

    for (let i = 0; i < length; i++) {
      addAddress();
      const keyList = Object.keys(addresses[i]);
      keyList.forEach(element => {
        document.getElementById(element + '' + i).value = addresses[i][element];
      });
    }

    document.getElementById('contactPerson').innerHTML = '';
    const contacts = allCompanies[index].contact;
    length = contacts.length
    contactSize = 0;

    for (let i = 0; i < length; i++) {
      addContact();
      const keyList = Object.keys(contacts[i]);
      keyList.forEach(element => {
        document.getElementById(element + '' + i).value = contacts[i][element];
      });
      setSelectedValue('addressType' + i, addresses[i].addressType);
    }
  }

  function submit() {
    const data = getSubmitData();
    $.post('/Company', data, (res) => {
      if (res) getCompanies();
    });
  }

  function deleteRecord(index) {
    const id = allCompanies[index].id;
    $.ajax({
      url: '/company', method: 'DELETE', data: { id: id }, success: res => {
        if (res.update) getUser();
      }
    });
  }

  function submitEdit() {
    if (!selectedId) return;

    const data = getSubmitData();
    data.id = selectedId;

    $.post('/Company', data, (res) => {
      if (res) getCompanies();
    });
  }
</script>